/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/plugins.py:24: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/home/sd6701/test/dinov2/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")
/home/sd6701/test/dinov2/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")
/home/sd6701/test/dinov2/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")
submitit ERROR (2025-11-28 23:59:29,792) - Submitted job triggered an exception
Traceback (most recent call last):
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/_submit.py", line 11, in <module>
    submitit_main()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 76, in submitit_main
    process_job(args.folder)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 69, in process_job
    raise error
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 55, in process_job
    result = delayed.result()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/utils.py", line 137, in result
    self._result = self.function(*self.args, **self.kwargs)
  File "/home/sd6701/test/dinov2/dinov2/run/train/train.py", line 26, in __call__
    train_main(self.args)
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 327, in main
    do_train(cfg, model, resume=not args.no_resume)
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 236, in do_train
    for data in metric_logger.log_every(
  File "/home/sd6701/test/dinov2/dinov2/logging/helpers.py", line 93, in log_every
    for obj in iterable:
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 4.
Original Traceback (most recent call last):
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/extended.py", line 26, in __getitem__
    image = ImageDataDecoder(image_data).decode()
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/decoders.py", line 23, in decode
    return Image.open(f).convert(mode="RGB")
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/PIL/Image.py", line 3560, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x152d0b9ba4d0>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/cc3m.py", line 90, in __getitem__
    return super().__getitem__(index)
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/extended.py", line 28, in __getitem__
    raise RuntimeError(f"can not read image for sample {index}") from e
RuntimeError: can not read image for sample 334140

srun: error: b-31-167: task 0: Exited with exit code 1
srun: Terminating StepId=122202.0
