/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/plugins.py:24: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/_submit.py", line 11, in <module>
    submitit_main()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 76, in submitit_main
    process_job(args.folder)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 55, in process_job
    result = delayed.result()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/utils.py", line 137, in result
    self._result = self.function(*self.args, **self.kwargs)
  File "/home/sd6701/test/dinov2/dinov2/run/train/train.py", line 23, in __call__
    from dinov2.train import main as train_main
  File "/home/sd6701/test/dinov2/dinov2/train/__init__.py", line 6, in <module>
    from .train import get_args_parser, main
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 15, in <module>
    from dinov2.data import SamplerType, make_data_loader, make_dataset
  File "/home/sd6701/test/dinov2/dinov2/data/__init__.py", line 7, in <module>
    from .loaders import make_data_loader, make_dataset, SamplerType
  File "/home/sd6701/test/dinov2/dinov2/data/loaders.py", line 13, in <module>
    from .datasets import ImageNet, ImageNet22k
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/__init__.py", line 6, in <module>
    from .image_net import ImageNet
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/image_net.py", line 14, in <module>
    from .extended import ExtendedVisionDataset
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/extended.py", line 8, in <module>
    from torchvision.datasets import VisionDataset
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/__init__.py", line 6, in <module>
    from torchvision import datasets, io, models, ops, transforms, utils
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/__init__.py", line 17, in <module>
    from . import detection, optical_flow, quantization, segmentation, video
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/detection/__init__.py", line 1, in <module>
    from .faster_rcnn import *
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/detection/faster_rcnn.py", line 16, in <module>
    from .anchor_utils import AnchorGenerator
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/detection/anchor_utils.py", line 10, in <module>
    class AnchorGenerator(nn.Module):
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/detection/anchor_utils.py", line 63, in AnchorGenerator
    device: torch.device = torch.device("cpu"),
/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/models/detection/anchor_utils.py:63: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device("cpu"),
/home/sd6701/test/dinov2/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")
/home/sd6701/test/dinov2/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")
/home/sd6701/test/dinov2/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")
submitit ERROR (2025-11-28 22:36:18,002) - Submitted job triggered an exception
Traceback (most recent call last):
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/_submit.py", line 11, in <module>
    submitit_main()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 76, in submitit_main
    process_job(args.folder)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 69, in process_job
    raise error
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/submission.py", line 55, in process_job
    result = delayed.result()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/submitit/core/utils.py", line 137, in result
    self._result = self.function(*self.args, **self.kwargs)
  File "/home/sd6701/test/dinov2/dinov2/run/train/train.py", line 26, in __call__
    train_main(self.args)
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 327, in main
    do_train(cfg, model, resume=not args.no_resume)
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 236, in do_train
    for data in metric_logger.log_every(
  File "/home/sd6701/test/dinov2/dinov2/logging/helpers.py", line 93, in log_every
    for obj in iterable:
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/cc3m.py", line 90, in __getitem__
    return super().__getitem__(index)
  File "/home/sd6701/test/dinov2/dinov2/data/datasets/extended.py", line 33, in __getitem__
    image, target = self.transforms(image, target)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/datasets/vision.py", line 94, in __call__
    input = self.transform(input)
  File "/home/sd6701/test/dinov2/dinov2/train/train.py", line 195, in data_transform
    return base_transform(img)
  File "/home/sd6701/test/dinov2/dinov2/data/augmentations.py", line 101, in __call__
    global_crop_1 = self.global_transfo1(im1_base)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/transforms/transforms.py", line 137, in __call__
    return F.to_tensor(pic)
  File "/home/sd6701/miniconda3/envs/dinov2/lib/python3.10/site-packages/torchvision/transforms/functional.py", line 166, in to_tensor
    img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))
RuntimeError: Numpy is not available

srun: error: b-31-118: task 0: Exited with exit code 1
srun: Terminating StepId=122177.0
